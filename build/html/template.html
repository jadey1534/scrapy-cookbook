<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>阿里云-光联SD-WAN项目交付故障演练报告 &mdash; Test 1.0 文档</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="RUNOOB Markdown Test" href="RUNOOB.html" />
    <link rel="prev" title="hello,world" href="hello.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Test
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Fastip产品:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="hello.html">hello,world</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">阿里云-光联SD-WAN项目交付故障演练报告</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">基本拓扑分析</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#image0">网络拓扑图</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id2">故障演练（2022/4/11）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vpngwipsecgw"> VPNGW故障——主IPSecgw中断</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3"> 控制器故障，转发正常</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cpe"> CPE掉电 /硬件故障（瞬断）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cpe-wan"> CPE互联网故障(wan瞬断)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cpe-lan-lan"> CPE LAN故障(lan)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4"> CPE流量过载</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id5">故障演练（2022/4/13）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vpngwipsecgw-1">VPNGW故障——主IPSecgw中断</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7"> CPE互联网故障(wan)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">CPE掉电 /硬件故障</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9"> 模拟打流测试</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MPLS VPN组网产品服务:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hello.html">hello,world</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Fastnet产品服务:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RUNOOB.html">RUNOOB Markdown Test</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Epoch产品服务:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="123.html">test</a></li>
<li class="toctree-l1"><a class="reference internal" href="RUNOOB.html">RUNOOB Markdown Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Cisco 单机-BGP配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPLS-MD.html">MPLS-md</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPLS-RST.html">MPLS-rst</a></li>
<li class="toctree-l1"><a class="reference internal" href="zabbix4.4%E6%90%AD%E5%BB%BA.html">zabbix4.4搭建</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">华为SD-WAN产品服务:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="123.html">test</a></li>
<li class="toctree-l1"><a class="reference internal" href="RUNOOB.html">RUNOOB Markdown Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Cisco 单机-BGP配置</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Test</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>阿里云-光联SD-WAN项目交付故障演练报告</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/template.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sd-wan">
<h1>阿里云-光联SD-WAN项目交付故障演练报告<a class="headerlink" href="#sd-wan" title="永久链接至标题">¶</a></h1>
<section id="id1">
<h2>基本拓扑分析<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<section id="image0">
<h3><a class="reference internal" href="_images/image6.png"><img alt="image0" src="_images/image6.png" style="width: 6.26736in; height: 4.02222in;" /></a>网络拓扑图<a class="headerlink" href="#image0" title="永久链接至标题">¶</a></h3>
<p><a class="reference internal" href="_images/image7.png"><img alt="image1" src="_images/image7.png" style="width: 6.68472in; height: 1.48681in;" /></a>北京站点：配备一台PC，PC与CE之间通过wifi连接，获得的地址为10.0.20.101/24，网关为10.0.20.1/24。</p>
<p>杭州站点：配备一台PC，PC与CE之间通过wfi连接，获得的地址为10.0.19.128/24，网关为10.0.19.1/24。</p>
<p>两个站点之间通过BGP路由宣告，实现了10.0.20.0/24网段与10.0.19.0/24网段的互访。</p>
</section>
</section>
<section id="id2">
<h2>故障演练（2022/4/11）<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<section id="vpngwipsecgw">
<h3> VPNGW故障——主IPSecgw中断<a class="headerlink" href="#vpngwipsecgw" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：验证当主IPSec连接故障，流量切换情况</strong></p>
<p><strong>预期结果：流量默认走主线路，当主线路down掉后，流量会切换到备线，过程中会短时间地出现丢包情况。</strong></p>
<p><strong>演练方式：在北京站点PC（10.0.20.101）与杭州点地wifi网关（10.0.19.1）有数据流量的情况下，由阿里工程师人为地在杭州点的主IPSGW上down掉接口配置，造成主IPSecGW与杭州CE的IPSec连接中断。</strong></p>
<p><strong>演练过程：</strong></p>
</div></blockquote>
<ol class="arabic simple">
<li><p><strong>时间节点4/12 0.06，北京站点ping操作正常，延迟波动范围为42-46ms</strong></p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="_images/image8.png"><img alt="image2" src="_images/image8.png" style="width: 5.59097in; height: 1.875in;" /></a><strong>图2.1.1 数据连接图</strong></p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>时间节点4/12
0.07,阿里工程师down掉上海节点主IPSec连接，数据流量中断，期间CE上bgp连接仍然存活。</p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="_images/image9.png"><img alt="image3" src="_images/image9.png" style="width: 5.61111in; height: 1.70764in;" /></a>图2.1.2 流量中断图</p>
<p><a class="reference internal" href="_images/image10.png"><img alt="image4" src="_images/image10.png" style="width: 5.54514in; height: 0.84444in;" /></a>图2.1.3 bgp状态查看图</p>
<p>3、时间节点4/12
0.10（3min）,流量切换到备线进行传输，延迟波动范围为340-380ms，CE上BGP状态为connect</p>
<p><a class="reference internal" href="_images/image11.png"><img alt="image5" src="_images/image11.png" style="width: 5.18056in; height: 1.75in;" /></a>图2.1.4 流量恢复图</p>
<p><a class="reference internal" href="_images/image12.png"><img alt="image6" src="_images/image12.png" style="width: 4.97778in; height: 0.80556in;" /></a>图2.1.5 bgp状态图</p>
</div></blockquote>
<p><strong>测试结论：</strong>基本符合预期，仍有较大整改空间。</p>
<blockquote>
<div><p><strong>整改措施：PE与CE双方配置的bgp hold
time时间为默认的180s，造成主备链路流程切换时间过长，预计调整CPE双方关于bgp
hold
time参数的配置，以期提高链路的情况检测的敏捷性，缩短链路切换的时间。见下期。</strong></p>
</div></blockquote>
</section>
<section id="id3">
<h3> 控制器故障，转发正常<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：验证当epoch中控与ce端的控制连接失效时，对数据流量的影响。</strong></p>
<p><strong>预期结果：CE与epoch中控的控制连接，不会对CE的数据流量造成影响</strong></p>
<p><strong>演练方式：在北京站点PC（10.0.20.101）与杭州点地wifi网关（10.0.19.1）有数据流量的情况下，由光联工程师人为地中断CE与epoch中控的控制连接，造成epoch中控无法登录管理CE设备。</strong></p>
<p><strong>演练过程：</strong></p>
</div></blockquote>
<ol class="arabic simple">
<li><p><strong>时间节点4/11 21.35
北京ping测试正常，在CE上断掉与epoch的控制通道连接，epoch中空上无法连接到CE端。</strong></p></li>
</ol>
<p><a class="reference internal" href="_images/image13.png"><img alt="image7" src="_images/image13.png" style="width: 4.77778in; height: 1.88681in;" /></a>图2.2.1 流量状况图</p>
<p><a class="reference internal" href="_images/image14.png"><img alt="image8" src="_images/image14.png" style="width: 4.84931in; height: 2.04861in;" /></a></p>
<p>图2.2.2 epoch中控图</p>
<ol class="arabic simple" start="2">
<li><p>时间节点4/11 21.37
恢复CE上与epoch中控的控制连接，过程中流量无影响，查看整个过程中的ping包无丢包情况。</p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="_images/image15.png"><img alt="image9" src="_images/image15.png" style="width: 5.46458in; height: 2.21667in;" /></a>图2.2.3 epoch中控图</p>
<p><a class="reference internal" href="_images/image16.png"><img alt="image10" src="_images/image16.png" style="width: 5.51319in; height: 1.72639in;" /></a>图2.2.4 数据包接收统计图</p>
<p><strong>测试结论：</strong>符合预期。</p>
</div></blockquote>
</section>
<section id="cpe">
<h3> CPE掉电 /硬件故障（瞬断）<a class="headerlink" href="#cpe" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：模拟CE设备短时间掉电的情况，以及对数据流量造成的影响。</strong></p>
<p><strong>预期结果：CE掉电过程中，数据流量中断，CE上电短时间内，网络恢复。</strong></p>
<p><strong>演练方式：在北京站点PC（10.0.20.101）与杭州点地wifi网关（10.0.19.1）有数据流量的情况下，由阿里工程师，手工拔插CE电源，形成CE短时间经历断电与上电的情况。</strong></p>
<p><strong>演练过程：</strong></p>
</div></blockquote>
<ol class="arabic simple">
<li><p><a class="reference internal" href="_images/image17.png"><img alt="image11" src="_images/image17.png" style="width: 5.89444in; height: 2.65347in;" /></a><strong>时间节点4/11 22.11
北京pc正常ping包，拔掉CE设备电源后一段时间插上</strong></p></li>
</ol>
<blockquote>
<div><p><strong>图2.3.1 数据流量图</strong></p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><strong>时间点4/11 22.13 预计IPSec重启时间为100s左右，数据重新连通。</strong></p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="_images/image18.png"><img alt="image12" src="_images/image18.png" style="width: 5.91042in; height: 0.93958in;" /></a><strong>图2.3.2 流量中断图</strong></p>
<p><a class="reference internal" href="_images/image19.png"><img alt="image13" src="_images/image19.png" style="width: 5.86042in; height: 1.18056in;" /></a>图2.3.3 bgp状态图</p>
<p><a class="reference internal" href="_images/image20.png"><img alt="image14" src="_images/image20.png" style="width: 5.28403in; height: 1.73333in;" /></a>图2.3.4 数据流量恢复图</p>
<p><strong>测试结论：符合预期。</strong></p>
</div></blockquote>
</section>
<section id="cpe-wan">
<h3> CPE互联网故障(wan瞬断)<a class="headerlink" href="#cpe-wan" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：验证当CE的互联网故障，造成主备IPSec连接中断的数据传输情况。</strong></p>
<p><strong>预期结果：CE的wan网络链路中断的情况下，数据流量会一直中断，等到网络恢复，数据流量随即恢复。</strong></p>
<p><strong>演练方式：在北京站点PC（10.0.20.101）与杭州点地wifi网关（10.0.19.1）有数据流量的情况下，由阿里工程师，拔插CE端的wan口线路，人为造成网络中断</strong></p>
<p><strong>演练过程：</strong></p>
</div></blockquote>
<ol class="arabic simple">
<li><p><strong>时间节点4/11 21.40 北京pc端ping流量测试正常</strong></p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="_images/image21.png"><img alt="image15" src="_images/image21.png" style="width: 5.33958in; height: 1.62639in;" /></a><strong>图2.4.1 流量连通图</strong></p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><a class="reference internal" href="_images/image22.png"><img alt="image16" src="_images/image22.png" style="width: 5.31042in; height: 2.47153in;" /></a>时间节点4/11 21.41
短时间内拔插wan口线路，造成数据中断与恢复</p></li>
</ol>
<blockquote>
<div><p>图2.4.2 流量恢复图</p>
<p><strong>测试结论：符合预期</strong></p>
</div></blockquote>
</section>
<section id="cpe-lan-lan">
<h3> CPE LAN故障(lan)<a class="headerlink" href="#cpe-lan-lan" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：验证当CE端，连接内网的端口down掉后，网络的数据传输情况</strong></p>
<p><strong>预期结果：CE的Lan网络链路中断的情况下，连接此端口的pc数据流量会一直中断，等到网络恢复，数据流量随即恢复。</strong></p>
<p><strong>演练方式：在北京站点PC（10.0.20.101）与杭州点地wifi网关（10.0.19.1）有数据流量的情况下，由光联工程师人为地down掉北京点的wifi接口，照成连接在此接口上的pc网络中断。</strong></p>
<p><strong>演练过程：</strong></p>
</div></blockquote>
<ol class="arabic simple">
<li><p><a class="reference internal" href="_images/image23.png"><img alt="image17" src="_images/image23.png" style="width: 5.42361in; height: 1.67153in;" /></a><strong>时间节点4/11 21.43
北京站点ping测试正常，短时间内在ce上down/up
wifi接口,造成lan口中断。</strong></p></li>
</ol>
<blockquote>
<div><p><strong>图2.5.1 数据连通图</strong></p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>时间节点 4/11
21.45恢复WiFi接口up状态，持续一段时间未恢复连接，pc端wifi已从其他ap获取IP，重新连接CE端WiFi（21.48）即可正常通信。</p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="_images/image24.png"><img alt="image18" src="_images/image24.png" style="width: 5.40278in; height: 3.24375in;" /></a>图2.5.2 数据中断图</p>
<p><a class="reference internal" href="_images/image25.png"><img alt="image19" src="_images/image25.png" style="width: 5.43056in; height: 1.78472in;" /></a>图2.5.3 数据恢复图</p>
<p><strong>测试结论：</strong>符合预期</p>
</div></blockquote>
</section>
<section id="id4">
<h3> CPE流量过载<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：验证当组网链路上存在大量数据时，对正常业务数据的影响情况</strong></p>
<p><strong>预期结果：当网络内出现大量数据时，数据流量整体时延会出现可接受范围的上升。</strong></p>
<p><strong>演练方式：在北京站点PC（10.0.20.101）与杭州点地wifi网关（10.0.19.1）有数据流量的情况下，由光联工程师与阿里云工程师，联合使用iperf3工具，形成大量流量数据传输，查看大流量数据形成后对原本的ping数据的整体时延影响情况。</strong></p>
<p><strong>演练过程：</strong></p>
</div></blockquote>
<ol class="arabic simple">
<li><p><strong>时间节点4/11 22.29
北京pc作为iperf3的服务端，杭州CE作为iperf3客户端，向北京pc发起udp流量。北京pc出现丢包和乱序的情况</strong></p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="_images/image26.png"><img alt="image20" src="_images/image26.png" style="width: 5.83264in; height: 2.66319in;" /></a><a class="reference internal" href="_images/image27.png"><img alt="image21" src="_images/image27.png" style="width: 5.8875in; height: 3.80278in;" /></a>图2.6.1 iperf3发送端状况图</p>
<p><strong>图2.6.2 iperf3 接收端状况图</strong></p>
<p><strong>测试结论：不符合预期</strong></p>
<p><strong>整改措施：演练过程中出现报文丢失，失序的情况，通过初步排查，判定数据传输过程中，本地带宽导致的丢包失序情况，接下来可以搭建新的实验场景，对流量满载情况的，流量传输质量进行再次测试。</strong></p>
</div></blockquote>
</section>
</section>
<section id="id5">
<h2>故障演练（2022/4/13）<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<section id="vpngwipsecgw-1">
<span id="id6"></span><h3>VPNGW故障——主IPSecgw中断<a class="headerlink" href="#vpngwipsecgw-1" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：验证当主IPSec连接故障，流量切换情况</strong></p>
<p><strong>预期结果：流量默认走主线路，当主线路down掉后，流量会切换到备线，通过配置BGP的hold-time时间为15秒，预计断线与切换的时间会持续15s。</strong></p>
<p><strong>演练方式：在北京站点的pc（10.0.20.101）向杭州站点CE（10.0.19.1）进行ping包测试，过程中，down掉杭州站点主线（上海线）的IPSec连接，观测流量数据切换情况.</strong></p>
<p><strong>数据观测记录：（下述时间节点并非真实时间，重在探测时间间隙）</strong></p>
<p><strong>通过在北京点ce上对端口进行抓包，实时查看接口的数据流量转发情况。</strong></p>
</div></blockquote>
<p><strong>图一数据显示，由10.0.20.1&lt;——&gt;10.0.19.1的数据流量正常转发。截至时间点：14：10：00，之后进行上海线路中断。</strong></p>
<p><strong>图二数据显示，由14：10：00至14：10：25这段时间，北京的主IPSec虚拟接口上都未有10.0.20.1&lt;——&gt;10.0.19.1的流量，至14：10：25之后开始出现连续的实验数据流量，整个过程共持续15s，符合实验预期。</strong></p>
<p><strong>测试结论：基本符合预期，仍有整改空间</strong></p>
<p><strong>整改措施：当主线恢复后，流量由备线切换回主线，经实验测试结果来说，大概一分种。需要根据实际情况调整配置参数，缩短由备线回切向主线的时间。</strong></p>
<blockquote>
<div><p><strong>数据截图：</strong></p>
</div></blockquote>
<p><a class="reference internal" href="_images/image28.png"><img alt="image22" src="_images/image28.png" style="width: 5.90972in; height: 1.98611in;" /></a></p>
<p>图3.1.1 ping流量来回正常</p>
<p><a class="reference internal" href="_images/image29.png"><img alt="image23" src="_images/image29.png" style="width: 6.48472in; height: 5.72153in;" /></a></p>
<p>图3.1.2 流量切换时间图</p>
<p><a class="reference internal" href="_images/image30.png"><img alt="image24" src="_images/image30.png" style="width: 6.05208in; height: 2.52083in;" /></a></p>
<p>图3.1.3 流量稳定情况图</p>
</section>
<section id="id7">
<h3> CPE互联网故障(wan)<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：验证当CE的互联网故障，造成主备IPSec连接中断及恢复的数据传输情况。</strong></p>
<p><strong>预期结果：CE的wan网络链路中断的情况下，数据流量会一直中断，等到网络恢复，数据流量经过一段时间恢复。</strong></p>
</div></blockquote>
<p><strong>演练方式：在杭州站点PC（10.0.19.128）与北京点的wifi网关（10.0.20.1）有数据流量的情况下，由阿里工程师，拔插CE端的wan口线路，过程持续5分钟，人为造成网络中断。</strong></p>
<p><strong>数据观测记录：（下述时间节点并非具体时间，重在观测时间间隙）</strong></p>
<p><strong>时间记录：杭州pc与北京CE数据传输正常，12:12，拔掉wan口，模拟网络中断，过程持续5分钟。</strong></p>
<p><strong>插回wan口网线时间为17：06</strong></p>
<p><strong>互联网（114.114.114.114）通的时间为17：19</strong></p>
<p><strong>中控连接时间点19：54</strong></p>
<p><strong>BGP状态切换为establish时间为，22.06/27</strong></p>
<p><strong>Ping流量测试连通时间22.40</strong></p>
<p><strong>综上，拔掉网线至数据流量恢复的时间共持续5m36s，其中，互联网连接上的时间为13s，中控连接时间为2m48s.</strong></p>
<p><strong>测试结论：不符合预期</strong></p>
<p><strong>整改措施：ipsec的IPSec
sa存活性和重连机制在当前配置下错误，同时IPSec协议本身在此不够完善。使用新配置可以缓解此处问题，后续将发布补丁从根本上解决。</strong></p>
<p><a class="reference internal" href="_images/image31.png"><img alt="image25" src="_images/image31.png" style="width: 6.03819in; height: 2.22569in;" /></a></p>
<p>图3.2.1 杭州pc与北京CE数据传输正常</p>
<p><a class="reference internal" href="_images/image32.png"><img alt="image26" src="_images/image32.png" style="width: 6.29514in; height: 1.4875in;" /></a></p>
<p>图3.2.2 杭州ce上查看BGP connect状态持续5分钟。</p>
<p><a class="reference internal" href="_images/image33.png"><img alt="image27" src="_images/image33.png" style="width: 6.38333in; height: 4.18958in;" /></a>图3.2.3 IPSec存活时间查看为22m51s</p>
</section>
<section id="id8">
<h3>CPE掉电 /硬件故障<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：模拟CE设备长时间掉电之后数据连接的恢复情况。</strong></p>
<p><strong>预期结果：CE掉电过程中，数据流量中断，CE上电经过一段时间后，私网互访正常。</strong></p>
<p><strong>演练方式：在杭州站点PC（10.0.19.128）与北京点地wifi网关（10.0.20.1）有数据流量的情况下，由阿里工程师，手工拔插CE电源（过程持续3分钟），形成CE经历持续一段时间的断电与上电的情况。</strong></p>
</div></blockquote>
<p><strong>数据观测记录：（下述时间节点并非具体时间，重在观测时间间隙）</strong></p>
<p>32：30，由阿里工程师拔掉杭州ce站点电源。</p>
<p>35：30，阿里工程师插回杭州ce站点电源</p>
<p>37：00，公网通（114.114.114.114），同期IPSec sa连接成功</p>
<p>37：37，控制平面连接成功</p>
<p>39：13 pc与CE之间的数据连接通路</p>
<p>综上：从上电到数据连通时间共持续4m13s，其中从启动到连接公网花费1m30s，连接公网之后接上控制平面花费37s，连接公网之后数据连通花费2m13s。</p>
<p><strong>测试结论：</strong>基本符合预期，仍有较大改进空间</p>
<p><strong>整改措施：</strong>在IPSec sa
up知道VPN胡同存在较大的时延，需要与阿里工程师再次场景复现，并协同诊断，后续发布补丁解决问题。</p>
<p><a class="reference internal" href="_images/image34.png"><img alt="image28" src="_images/image34.png" style="width: 6.04931in; height: 1.66389in;" /></a></p>
<p>图3.3.1 杭州pc与北京CE数据连接成功</p>
<p><a class="reference internal" href="_images/image35.png"><img alt="image29" src="_images/image35.png" style="width: 6.03681in; height: 1.57083in;" /></a>图3.3.2 BGP连接成功</p>
<p><a class="reference internal" href="_images/image36.png"><img alt="image30" src="_images/image36.png" style="width: 6.03542in; height: 3.53889in;" /></a></p>
<p>图3.3.3 于38：15查看IPSec以启动1m6s，预计启动时间为37：07</p>
</section>
<section id="id9">
<h3> 模拟打流测试<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p><strong>演练目的：组网链路能否在100M的数据传输情况下，进行数据的稳定传输</strong></p>
<p><strong>预期结果：当网络内出现100M/s的数据时，数据基本能够稳定传输，丢包情况在可接收范围内。</strong></p>
<p><strong>演练方式：两台ce分别连接到两台pe，ce之间使用iperf工具进行大流量模拟</strong></p>
<p><strong>数据观测记录：</strong>100M的测试环境的打流，模拟北京到杭州的测试环境，打流100M
实际能够达到到91M。（考虑本地链路的传输情况，基本符合预期）</p>
</div></blockquote>
<p><a class="reference internal" href="_images/image37.png"><img alt="image31" src="_images/image37.png" style="width: 5.20833in; height: 3.09514in;" /></a></p>
<p>图3.4.1 iperf使用tcp进行大流量模拟</p>
<p><a class="reference internal" href="_images/image38.png"><img alt="image32" src="_images/image38.png" style="width: 5.125in; height: 2.60417in;" /></a></p>
<p>图3.4.2 iperf使用udp进行大流量模拟</p>
<p><strong>测试结论：</strong>符合预期</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hello.html" class="btn btn-neutral float-left" title="hello,world" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="RUNOOB.html" class="btn btn-neutral float-right" title="RUNOOB Markdown Test" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, Jade.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>